{% extends "/Client-Home-Page/base.html" %}{% block title %}{{ product.ProductName }}{% endblock %} {% block content%}

<!-- Include jQuery -->
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>

<!-- Include DataTables CSS -->
<link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/1.13.7/css/jquery.dataTables.min.css">

<!-- Include DataTables JS -->
<script src="https://cdn.datatables.net/1.13.7/js/jquery.dataTables.min.js"></script>

<!-- Include DataTables Buttons CSS and JS -->
<link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/buttons/2.3.5/css/buttons.dataTables.min.css">
<script src="https://cdn.datatables.net/buttons/2.3.5/js/dataTables.buttons.min.js"></script>
<script src="https://cdn.datatables.net/buttons/2.3.5/js/buttons.html5.min.js"></script>

<!-- Include DataTables Print Button JS -->
<script src="https://cdn.datatables.net/buttons/2.3.5/js/buttons.print.min.js"></script>

<!-- Add Font Awesome CDN -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css" rel="stylesheet">


<main id="main" class="main">

  <div class="pagetitle">
    <h1>{{ product.ProductName }}</h1>
  </div><!-- End Page Title -->

  <section class="section">
    <div class="d-flex flex-column flex-md-row align-items-center">
      <!-- Image on the left side for larger screens -->
      <img src="https://lh3.googleusercontent.com/d/{{product.ProductImage}}"
           alt="Product Image"
           class="img-fluid rounded mb-3 mb-md-0"
           style="max-width: 250px; max-height: 250px; object-fit: cover;">
    
      <!-- Product Description -->
      <div class="card ms-md-3 flex-fill">
        <div class="card-body">
          <h5 class="card-title">Description</h5>
          <p>{{ product.ProductDescription }}</p>
        </div>
      </div>
    </div>

    <!-- Product Details Section -->
    <div class="card mt-2">
      <div class="card-body">
        <div class="product-details">
          <h5 class="card-title">Product Details</h5>
          <!-- Profile Picture in the top-right corner -->
          <img 
            src="https://lh3.googleusercontent.com/d/{{product.MSAccount.ProfilePic}}" 
            alt="Seller Profile Picture" 
            class="img-fluid rounded-circle position-absolute top-0 end-0 m-2" 
            style="width: 50px; height: 50px; object-fit: cover; border: 2px solid #ddd;"
          >
          <p class="mb-1"><strong>Seller:</strong> {{ product.MSAccount.FirstName }} {{ product.MSAccount.LastName }}</p>
          <p class="mb-1"><strong>Price:</strong> â‚±{{ product.ProductPrice }}</p>
          <p class="mb-1"><strong>Stocks:</strong> {{ product.ProductStock }}</p>
          <p class="mb-2">
            <strong>Rating:</strong><br>
            {% if product.average_rating is not none %}
              <span class="stars">
                {% for i in range(1, 6) %}
                  {% if i <= product.average_rating %}
                    <i class="fas fa-star text-warning"></i>  <!-- Full star in yellow -->
                  {% elif i - 0.5 <= product.average_rating %}
                    <i class="fas fa-star-half-alt text-warning"></i>  <!-- Half star in yellow -->
                  {% else %}
                    <i class="far fa-star text-warning"></i>  <!-- Empty star in yellow -->
                  {% endif %}
                {% endfor %}
              </span>
            {% else %}
              No ratings yet
            {% endif %}
          </p>
          
          <!-- Action buttons (Add to Cart and Purchase) -->
          <div class="row mb-1">
            <div class="col text-end">
              <form action="/products/add-to-cart" method="POST" enctype="multipart/form-data" accept-charset="utf-8">
                <input type="hidden" name="prid" value="{{product.id}}"></input>
                <input type="hidden" name="prname" value="{{product.ProductName}}"></input>
                <input type="hidden" name="prowner" value="{{product.MSAccount.MSId}}"></input>
                <button type="submit" class="btn btn-primary">
                <i class="fa fa-cart-plus"></i> Add to cart
              </button>
            </form>
            </div>
          </div>
          <div class="row mb-1">
            <div class="col text-end">
              <form action="/purchase/{{product.id}}">

              <button type="submit" class="btn btn-danger" data-bs-dismiss="modal" aria-label="Close">
                <i class="fa fa-credit-card"></i> Purchase
              </button>
            </form>
            </div>
          </div>
        </div>
      </div>
    </div>

   <!-- Reviews Section -->
<div class="card mt-3">
  <div class="card-body">
    <h5 class="card-title">Reviews</h5>

    {% if reviews %}
      <!-- Display the number of reviewers -->
      <p class="text-muted mb-3">
        {{ reviews|length }} user{{ reviews|length > 1 and "s" or "" }} reviewed this product.
      </p>

      {% for review in reviews %}
        <div class="d-flex align-items-start mb-3">
          <!-- Reviewer Picture -->
          <img src="https://lh3.googleusercontent.com/d/{{ review.ProfilePic or 'default_profile_pic.png' }}" 
               alt="Reviewer Picture" 
               class="rounded-circle me-3" 
               style="width: 50px; height: 50px; object-fit: cover; border: 2px solid #ddd;">
          
          <!-- Reviewer Details -->
          <div>
            <p class="mb-1"><strong>{{ review.FirstName }} {{ review.LastName }}</strong></p>
            <p class="mb-1">
              {% for i in range(1, 6) %}
                {% if i <= review.Rate1 %}
                  <i class="fas fa-star text-warning"></i>
                {% else %}
                  <i class="far fa-star text-warning"></i>
                {% endif %}
              {% endfor %}
            </p>
            {% if review.Review != None %}
            <p class="text-muted">{{ review.Review }}</p>
                {% else %}
                <p class="text-muted">No Comment</p> 
                {% endif %}
            
          </div>
        </div>
      {% endfor %}
    {% else %}
      <p class="text-muted">No reviews yet for this product.</p>
    {% endif %}
  </div>
</div>

    <!-- Visits Info Section -->
    <div class="card-footer text-center bg-light">
      <span class="me-2"><i class="bi bi-eye"></i></span> <!-- Eye icon -->
      <span>{{ product.ProductViews }} Views</span> <!-- Display visits info -->
    </div>

    <br><br>

   
    {% include "/Client-Home-Page/Recommend/index.html" %}  <!-- Recommended -->

    <br><br><br>

  </section>
  
</main>


{% endblock %}


      